<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Github Repo Preparation  :: AWS System Manager</title>

    
    <link href="/css/nucleus.css?1690341069" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1690341069" rel="stylesheet">
    <link href="/css/hybrid.css?1690341069" rel="stylesheet">
    <link href="/css/featherlight.min.css?1690341069" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1690341069" rel="stylesheet">
    <link href="/css/auto-complete.css?1690341069" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1690341069" rel="stylesheet">
    <link href="/css/theme.css?1690341069" rel="stylesheet">
    <link href="/css/hugo-theme.css?1690341069" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1690341069" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1690341069"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/1-cicd/1.1-setupgithubandecr/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1690341069"></script>
<script type="text/javascript" src="/js/auto-complete.js?1690341069"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1690341069"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-cicd/" title="Preparation and design of CI/CD Pipeline" class="dd-item 
        parent
        
        
        ">
      <a href="/1-cicd/">
           <b> 1 </b> Preparation and design of CI/CD Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.1-setupgithubandecr/" title="Github Repo Preparation " class="dd-item 
        
        active
        
        ">
      <a href="/1-cicd/1.1-setupgithubandecr/">
           <b> 1.1 </b> Github Repo Preparation 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.2-setupecrrepo/" title="Setup repo cho AWS ECR" class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/1.2-setupecrrepo/">
           <b> 1.2 </b> Setup repo cho AWS ECR
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.3-deployoncloud/" title="Deploy CI/CD pipeline to AWS" class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/1.3-deployoncloud/">
           <b> 1.3 </b> Deploy CI/CD pipeline to AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-runtask/" title="Designing AWS Batch and S3 to run crawlers and save results" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/">
           <b> 2 </b> Designing AWS Batch and S3 to run crawlers and save results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-runtask/2.1-awsbatch/" title="AWS Batch Design" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/2.1-awsbatch/">
           <b> 2.1 </b> AWS Batch Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-runtask/2.2-eventands3/" title="Create a schedule to submit jobs using EventBridge and save the results to S3" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/2.2-eventands3/">
           <b> 2.2 </b> Create a schedule to submit jobs using EventBridge and save the results to S3
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-frontendapp/" title="Create a Frontend Webapp to see the results" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/">
           <b> 3. </b> Create a Frontend Webapp to see the results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-frontendapp/3.1-vpc/" title="Network Environment Design" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/3.1-vpc/">
           <b> 3.1. </b> Network Environment Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-frontendapp/3.2-elb/" title="Generate resources: ALB and ASG" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/3.2-elb/">
           <b> 3.2. </b> Generate resources: ALB and ASG
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-result/" title="Results" class="dd-item 
        
        
        
        ">
      <a href="/4-result/">
           <b> 4. </b> Results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-cleanup/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="/5-cleanup/">
           <b> 5. </b> Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-cdk/" title="Building a workshop with CDK" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/">
           <b> 6. </b> Building a workshop with CDK
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.1-cicd/" title="CI/CD Pipeline Design" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.1-cicd/">
           <b> 6.1. </b> CI/CD Pipeline Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.2-runtask/" title="AWS Batch Design" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.2-runtask/">
           <b> 6.2. </b> AWS Batch Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.3-wrapup/" title="Frontend Webapp Design" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.3-wrapup/">
           <b> 6.3. </b> Frontend Webapp Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.3-frontend/" title="Complete, Run CDK and Clean dep" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.3-frontend/">
           <b> 6.4. </b> Complete, Run CDK and Clean dep
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/1-cicd/1.1-setupgithubandecr/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/1-cicd/1.1-setupgithubandecr/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>30-01-2022</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i> <a href="https://www.linkedin.com/in/sutrinh/"  style="color:orange">Sử Trịnh  </a> <br>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
                <a href="https://www.linkedin.com/in/hiepnguyendt"  style="color:orange">Thanh Hiệp </a>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Introduction and Preparation</a> > <a href='/1-cicd/'>Preparation and design of CI/CD Pipeline</a> > Github Repo Preparation 
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#getting-crawler-and-push-to-github">Getting Crawler and Push to Github</a>
      <ul>
        <li><a href="#2-dockerfile-and-requirementstxt">2. dockerfile and requirements.txt</a></li>
        <li><a href="#3-buildspecyml">3. buildspec.yml</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Github Repo Preparation 
            </h1>
          

        



	<p>In this article, you will prepare the necessary files for the following articles. I&rsquo;ll go through each section. In this lab, I will use VsCode to prepare all files in the local environment and push to Github. I also use the console to deploy the architecture to the cloud. In the second part of the workshop, I will show how you can deploy with CDK (Cloud Development Kit) if you want to learn more about IaC.</p>
<h2 id="getting-crawler-and-push-to-github">Getting Crawler and Push to Github</h2>
<p>First of all, you need to prepare the crawler file and push it to Github. This will be the crawler that we will deploy to the cloud. Please go to the following Github link: [Github Crawler] (<a href="https://github.com/MinhThieu145/Job-Scraper-Home.git)">https://github.com/MinhThieu145/Job-Scraper-Home.git)</a>. After entering, clone this repo to your computer. You can clone by running the following command:</p>
<pre tabindex="0"><code>git clone -b indeed-scraper https://github.com/MinhThieu145/Job-Scraper-Home.git
</code></pre><p>If you have an error in the above statement, try using:</p>
<pre tabindex="0"><code>git --version
</code></pre><p>If you see the results returned clearly show the git version. You have successfully installed Git. If not, you need to install git before clone repo. You can install git by referring to the following link [How to install Github for VsCode] (<a href="https://www.geeksforgeeks.org/how-to-install-git-in-vs-code/)">https://www.geeksforgeeks.org/how-to-install-git-in-vs-code/)</a>. Once the clone is complete, you will have a repo as follows:</p>
<p>``markdown
📦 Job-Scraper-Home
📂 .git
📂 <strong>pycache</strong>
📂 result
📜 .gitignore
📜 buildspec.yml
📜 dockerfile
📜 exploration.ipynb
📜 job_description_analyzer.py
📜 main.py
📜 requirements.txt
📜 scraper.py</p>
<pre tabindex="0"><code>
I will go through each file and folder that you need to know in this repo:

### 1. main.py and scraper.py
The first is the**main.py** file. The file runs the scraper.py file and contains the results in a folder named results (which will create a new folder if it doesn&#39;t exist). Finally, the script will push all the files in the results folder to S3.

``python
# import indeed scraper
import scraper

# import analyse data function
import job_description_analyzer

# some other libraries
import os
import pandas as pd

# main function
def main ():

# clean the result folder
# get current dir
current_dir = os.getcwd ()

# get the result folder if exit
try:
# if the result folder exists
result_dir = os.path.join (current_dir, &#39;result&#39;)
# delete all the files in the result folder
for file in os.listdir (result_dir):
os.remove (os.path.join (result_dir, file))

        
except:
# create a new folder called result
os.mkdir (&#39;result&#39;)
result_dir = os.path.join (current_dir, &#39;result&#39;)


# run the scraper
scraper.main ()

# get the result from a folder called result

# loop through the result folder
for file in os.listdir (result_dir):
# if that is a csv file
if file.endswith (&#39;.csv&#39;):
# read with pandas
df = pd.read_csv (os.path.join (result_dir, file))

# if the dataframe is not empty
if not df.empty:
# pass that to the analyse data function
job_description_analyzer.main (df=df, df_name=file.split (&#39;.&#39;) [ 0])
                    


if __name__ == “__main__”:
main ()
</code></pre><p>If you read the code carefully, you will see main.py loop through all the files that end <strong>.csv</strong> in the results folder and call another function in <strong>job_description_analyzer.py</strong> before pushing to S3. The reason is that I cut the repo a lot short. Initially, the crawler will have the following tasks.</p>
<ul>
<li>main.py will go to S3 to find crawlers (each website is a different crawler) and run these crawlers.</li>
<li>After all, these crawlers will save the results in the results folder. - After that, the job_description_analyzer.py file is responsible for extracting keywords and important information using the GPT API, before saving the results again</li>
<li>Finally, both initial and post-processing scrap results are pushed to S3.</li>
</ul>
<p>Because this process is quite long, perishable and inefficient when almost completely processed by code. If you want to try it again, you can use AWS Step Function and AWS SNS to decouple parts, to ensure execution order and pipeline stability. In this lab, I&rsquo;m not going to go through that part.</p>
<h3 id="2-dockerfile-and-requirementstxt">2. dockerfile and requirements.txt</h3>
<p>These are the two files needed to build a docker image from code. In File DockerFile, I did</p>
<ul>
<li>Use the based image as <strong>Ubuntu:22.04</strong>. But you can use other base images, as long as you have Python3 preset. Otherwise you will have to install Python3 yourself</li>
<li>Install and update pip to download necessary packages for crawler. The names of these packages are stored in the file <strong>requirements.txt</strong>. In this lab, I used boto3 to be able to call AWS APIs, openai to be able to call API of GPT3 (can be abandoned because it is no longer used), pandas to process data, selenium to be able to run crawler and webdriver_manager to be able to automatically load drivers for selenium. All of these packages are stored in the requirements.txt file. You can add or remove these packages as you wish.</li>
</ul>
<p>``r
boto3==1.26.165
openai==0.27.7
pandas==1.5.3
selenium==4.10.0
tenacity==8.2.2
webdriver_manager==3.8.6</p>
<pre tabindex="0"><code>- Install Chrome browser for images. 
- Finally, copy the files into the docker image

You can read your dockerfile here

``dockerfile
# based image: Ubuntubased. BTW, for the PYTHON:3.9 like you used last time. It used the Debianbased image

FROM public.ecr.aws/docker/library/ubuntu:22.04

# install a few things
RUN apt-get update &amp;&amp; apt-get install -y\
bash\
git\
curl\
software-properties-common\
pip\
&amp;rm -rf /var/lib/apt/lists/ *

# workdir
WORKDIR /srv

# okay now pip
RUN apt-get -y update
RUN pip install --upgrade pip

# Copy the requirements.txt file first, for separate dependency resolving and downloading
COPY requirements.txt.
RUN pip install -r requirements.txt

# Install chrome broswer
RUN curl -SS -o - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -
RUN echo “deb http://dl.google.com/linux/chrome/deb/ stable main” &gt;&gt; /etc/apt/sources.list.d/google-chrome.list
RUN apt-get -y update
RUN apt-get -y install google-chrome-stable

# add the main.py
COPY main.py.

# add scraper
COPY scraper.py.

# add job_description_analyzer
COPY job_description_analyzer.py.

ENTRYPOINT [“python3&#34;,&#34; main.py &#34;]
</code></pre><h3 id="3-buildspecyml">3. buildspec.yml</h3>
<p>There is one more file that you need to pay attention to, which is the <strong>buildspec.yml</strong> file. This file is extremely important, as it shows AWS Codebuild how to build your image. Buildspec is divided into three phases, pre_build, build and post_build.</p>
<p>``yaml
Version: 0.2</p>
<p>Phases:
pre_build:
commands:</p>
<ul>
<li>echo “Logging in to ECR”</li>
<li>aws &ndash;verzija</li>
<li>AWS_default_region=US-East-1</li>
<li>AWS_ACCOUNT_ID=238101178196</li>
<li>image_tag=Latest</li>
<li>repository_uri=238101178196.dkr. ecr.us-east-1.amazonaws.com /indeed-scraper</li>
<li>aws ecr get-login-password &ndash;region $AWS_DEFAULT_REGION | docker login &ndash;username AWS &ndash;password-stdin $aws_account_id.dkr.ecr. $AWS_Default_Region.amazonaws.com</li>
</ul>
<p>build:
commands:</p>
<ul>
<li>echo “Building the Docker image&hellip;”</li>
<li>docker build -t $REPOSITORY_URI: $IMAGE_TAG.</li>
<li>docker push $REPOSITORY_URI: $IMAGE_TAG</li>
</ul>
<p>post_build:
commands:</p>
<ul>
<li>echo “Updating ECS service&hellip;”</li>
<li>echo “End of script”</li>
</ul>
<p>artifacts:
filer:</p>
<ul>
<li>&lsquo;**/*&rsquo;
name: artifacts</li>
</ul>
<pre tabindex="0"><code>
In phase **pre_build**, I saved the environment variables as follows:

- **AWS_DEFAULT_REGION: ** region that you use for this workshop, I use us-east-1 (virginia)
- **AWS_ACCOUNT_ID: ** Your AWS Account ID, which can be found in the account section
! [ lol] (/images/2023-07-09-09-52-36.png)
- **IMAGE_TAG**: The tag of the image you want to get in ECR. During the build process, you will update the image several times, each time with a tag + 1. The latest tag will help you get the latest image.
- **REPOSITORY_URI: ** The link of ECR repo contains the image, I will create right at the bottom.
- The last line of the phase is for me to authenticate my script, which allows me to execute commands in Docker such as Push or Pull image from Ecr.
  
In phase **build, we will build the image and push it to the ECR repo. 

- `docker build -t $REPOSITORY_URI: $IMAGE_TAG .` I build image and set tag as **latest**. This is the IMAGE_TAG variable I set before. Remember that there is a dot after IMAGE_TAG.
- `docker push $REPOSITORY_URI: $IMAGE_TAG` I push Docker image I just built to Ecr repo. In this paragraph, if you follow me, you will be stuck because you haven&#39;t created a repo, so you can leave this variable blank, and read on to learn how to create a repo.
  
Finally, the post_build phase. I just log to the console to announce it is complete. This phase does not execute orders at all.

## Deploy Github repo to Github.
After completing the preparation of the files, the next step is to push the repo to Github. First, you need to open the folder you just cloned the repo to. In VsCode it will look like this
![](/images/2023-07-19-18-32-06.png)

1. Check if you already have git with `git --version`. Next, you need to remove the **.git file from the folder as the folder is still associated with your Github repo. Use this command to remove the file .git `rm -rf .git`. Then you need to create a new repo on your Github. 
2. `git init -b main` to initialize the new repo. 
3. `git add .` to add all files in the folder to the repo
4. `git commit -m “Initial commit&#34;` to commit files just added to the repo
5. Go to your github account, create a new repo and copy the URL 
6. `git remote add &lt;URL&gt;origin` to add new repo to your local repo
7. `git push -u origin main` to push repo to Github. If you fail, try `git push -f origin main` to force push.
8. After the push is done, you can see that your repo has been updated
</code></pre>




<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/1-cicd/" title="Preparation and design of CI/CD Pipeline"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/1-cicd/1.2-setupecrrepo/" title="Setup repo cho AWS ECR" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1690341069"></script>
    <script src="/js/perfect-scrollbar.min.js?1690341069"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1690341069"></script>
    <script src="/js/jquery.sticky.js?1690341069"></script>
    <script src="/js/featherlight.min.js?1690341069"></script>
    <script src="/js/highlight.pack.js?1690341069"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1690341069"></script>
    <script src="/js/learn.js?1690341069"></script>
    <script src="/js/hugo-learn.js?1690341069"></script>

    <link href="/mermaid/mermaid.css?1690341069" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1690341069"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
