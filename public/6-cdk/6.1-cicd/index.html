<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>CI/CD Pipeline Design :: AWS System Manager</title>

    
    <link href="/css/nucleus.css?1690341069" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1690341069" rel="stylesheet">
    <link href="/css/hybrid.css?1690341069" rel="stylesheet">
    <link href="/css/featherlight.min.css?1690341069" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1690341069" rel="stylesheet">
    <link href="/css/auto-complete.css?1690341069" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1690341069" rel="stylesheet">
    <link href="/css/theme.css?1690341069" rel="stylesheet">
    <link href="/css/hugo-theme.css?1690341069" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1690341069" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1690341069"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/6-cdk/6.1-cicd/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1690341069"></script>
<script type="text/javascript" src="/js/auto-complete.js?1690341069"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1690341069"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-cicd/" title="Preparation and design of CI/CD Pipeline" class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/">
           <b> 1 </b> Preparation and design of CI/CD Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.1-setupgithubandecr/" title="Github Repo Preparation " class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/1.1-setupgithubandecr/">
           <b> 1.1 </b> Github Repo Preparation 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.2-setupecrrepo/" title="Setup repo cho AWS ECR" class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/1.2-setupecrrepo/">
           <b> 1.2 </b> Setup repo cho AWS ECR
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/1-cicd/1.3-deployoncloud/" title="Deploy CI/CD pipeline to AWS" class="dd-item 
        
        
        
        ">
      <a href="/1-cicd/1.3-deployoncloud/">
           <b> 1.3 </b> Deploy CI/CD pipeline to AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-runtask/" title="Designing AWS Batch and S3 to run crawlers and save results" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/">
           <b> 2 </b> Designing AWS Batch and S3 to run crawlers and save results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-runtask/2.1-awsbatch/" title="AWS Batch Design" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/2.1-awsbatch/">
           <b> 2.1 </b> AWS Batch Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-runtask/2.2-eventands3/" title="Create a schedule to submit jobs using EventBridge and save the results to S3" class="dd-item 
        
        
        
        ">
      <a href="/2-runtask/2.2-eventands3/">
           <b> 2.2 </b> Create a schedule to submit jobs using EventBridge and save the results to S3
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-frontendapp/" title="Create a Frontend Webapp to see the results" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/">
           <b> 3. </b> Create a Frontend Webapp to see the results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3-frontendapp/3.1-vpc/" title="Network Environment Design" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/3.1-vpc/">
           <b> 3.1. </b> Network Environment Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-frontendapp/3.2-elb/" title="Generate resources: ALB and ASG" class="dd-item 
        
        
        
        ">
      <a href="/3-frontendapp/3.2-elb/">
           <b> 3.2. </b> Generate resources: ALB and ASG
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-result/" title="Results" class="dd-item 
        
        
        
        ">
      <a href="/4-result/">
           <b> 4. </b> Results
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-cleanup/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="/5-cleanup/">
           <b> 5. </b> Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-cdk/" title="Building a workshop with CDK" class="dd-item 
        parent
        
        
        ">
      <a href="/6-cdk/">
           <b> 6. </b> Building a workshop with CDK
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.1-cicd/" title="CI/CD Pipeline Design" class="dd-item 
        
        active
        
        ">
      <a href="/6-cdk/6.1-cicd/">
           <b> 6.1. </b> CI/CD Pipeline Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.2-runtask/" title="AWS Batch Design" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.2-runtask/">
           <b> 6.2. </b> AWS Batch Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.3-wrapup/" title="Frontend Webapp Design" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.3-wrapup/">
           <b> 6.3. </b> Frontend Webapp Design
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/6-cdk/6.3-frontend/" title="Complete, Run CDK and Clean dep" class="dd-item 
        
        
        
        ">
      <a href="/6-cdk/6.3-frontend/">
           <b> 6.4. </b> Complete, Run CDK and Clean dep
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/6-cdk/6.1-cicd/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/6-cdk/6.1-cicd/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>30-01-2022</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i> <a href="https://www.linkedin.com/in/sutrinh/"  style="color:orange">Sử Trịnh  </a> <br>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
                <a href="https://www.linkedin.com/in/hiepnguyendt"  style="color:orange">Thanh Hiệp </a>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Introduction and Preparation</a> > <a href='/6-cdk/'>Building a workshop with CDK</a> > CI/CD Pipeline Design
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#create-github-source-1">Create Github Source</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              CI/CD Pipeline Design
            </h1>
          

        



	<p>In the previous lab, you learned how to create crawler pipelines with Codebuild. In this section, I will use CDK to do the same. In the repo that you clone, in the folder <strong>workshop1</strong> there is a python file: <strong>cicd_stack.py</strong>. This is the CI/CD pipeline setup file for crawler. I&rsquo;ll go through each section of this file. The first is an overview of the file:
``python
from ws_cdk import (</p>
<h1 id="duration">Duration,</h1>
<p>Stack,</p>
<h1 id="aws-codebuild">aws codebuild</h1>
<p>aws_codebuild as codebuild,</p>
<h1 id="aws-iam">aws iam</h1>
<p>aws_iam as iam,
)
from constructs import Construct</p>
<h1 id="some-pther-lib">Some pther lib</h1>
<p>import os</p>
<h1 id="load-the-data-for-the-codebuild-from-environment-variables">load the data for the CodeBuild from environment variables</h1>
<p>from dotenv import load_dotenv
load_dotenv ()</p>
<p>GITHUB_OWNER = os.getenv (“OWNER”)
GITHUB_REPO = os.getenv (“REPO”)
GITHUB_BRANCH = os.getenv (“BRANCH”)</p>
<h1 id="please-use-this-line-to-add-credential-to-the-codebuild">please use this line to add credential to the CodeBuild</h1>
<h1 id="aws-codebuild-import-source-credentials---server-type-github---auth-type-personal_access_token---token-token_value">aws codebuild import-source-credentials &ndash;server-type GITHUB &ndash;auth-type PERSONAL_ACCESS_TOKEN &ndash;token &lt;token_value&gt;</h1>
<h1 id="the-personal-token-needs-to-have-enough-permission-to-access-the-repo">The personal token needs to have enough permission to access the repo</h1>
<p>CICDStack class (Stack):</p>
<p>def <strong>init</strong> (self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
super () .<strong>init</strong> (scope, construct_id, **kwargs)</p>
<h1 id="create-the-codebuild-project">Create the CodeBuild Project</h1>
<h1 id="create-github-source">Create Github Source</h1>
<p>github_source = codebuild.source.git_hub (
owner=f &ldquo;{GITHUB_OWNER}”,
repo=f &ldquo;{GITHUB_REPO}”,
webhook=True,
branch_or_ref=f &ldquo;{GITHUB_BRANCH}”,</p>
<h1 id="there-are-an-option-called-webhook_filters-that-is-for-the-webhook-event-filter-on-aws-leave-it-as-default">there are an option called webhook_filters: that is for the Webhook Event Filter on AWS. Leave it as default</h1>
<p>)</p>
<h1 id="create-the-role-for-the-codebuild-project">Create the role for the CodeBuild Project</h1>
<p>codebuild_role = iam.role (
scope=self,
id=&ldquo;JobScrapingCicDrole”,
role_name=&ldquo;JobScrapingCicDrole”,
Assumed_by=Iam.servicePrincipal (“codebuild.amazonaws.com”),</p>
<h1 id="add-the-full-s3-access-to-the-role">add the full S3 access to the role</h1>
<p>managed_policies= [
IAM.ManagedPolicy.From_AWS_Managed_Policy_Name (
managed_policy_name=&ldquo;Amazons3fullAccess”
),</p>
<h1 id="add-full-ecr-access-to-the-role">add full ECR access to the role</h1>
<p>IAM.ManagedPolicy.From_AWS_Managed_Policy_Name (
managed_policy_name=&ldquo;Amazonec2ContainerRegistryFullAccess”
),</p>
<p>]]</p>
<p>)</p>
<h1 id="create-the-codebuild-project-1">Create the CodeBuild Project</h1>
<p>CodeBuild.project (
scope=self,
id=&ldquo;cicdproject”,
project_name=&ldquo;cicdproject”,</p>
<h1 id="add-description">add description</h1>
<p>Description=&ldquo;CodeBuild Project for the CICD for Job Scraping Project”,</p>
<h1 id="set-the-source">set the source</h1>
<p>source=github_source,</p>
<h1 id="add-some-environment-variables">add some environment variables</h1>
<p>environment=CodeBuild.BuildEnvironment (</p>
<h1 id="add-the-base-environment-variable">add the Base Environment Variable</h1>
<p>build_image=codebuild.linuxbuildimage.standard_7_0,</p>
<h1 id="set-the-privilege-to-true-for-docker-build">set the privilege to true for docker build</h1>
<p>privileged=True,             <br>
),</p>
<h1 id="create-role-for-the-codebuild-project">Create role for the CodeBuild Project</h1>
<p>role=codebuild_role,
)</p>
<pre tabindex="0"><code>
## Preparation of environment variables for Codebuild.
Instead of connecting directly to Github as you use the console, you must use the variable environment to pass information into Codebuild. I will use the **dotenv library to load the environment variables from the **.env** file, but you can leave it in the code. 

``python
# load the data for the CodeBuild from environment variables
from dotenv import load_dotenv
load_dotenv ()

GITHUB_OWNER = os.getenv (“OWNER”)
GITHUB_REPO = os.getenv (“REPO”)
GITHUB_BRANCH = os.getenv (“BRANCH”)
</code></pre><p>In addition, I also import the necessary libraries for the stack
``python
from ws_cdk import (</p>
<h1 id="duration-1">Duration,</h1>
<p>Stack,</p>
<h1 id="aws-codebuild-1">aws codebuild</h1>
<p>aws_codebuild as codebuild,</p>
<h1 id="aws-iam-1">aws iam</h1>
<p>aws_iam as iam,
)
from constructs import Construct</p>
<h1 id="some-pther-lib-1">Some pther lib</h1>
<p>import os</p>
<h1 id="load-the-data-for-the-codebuild-from-environment-variables-1">load the data for the CodeBuild from environment variables</h1>
<p>from dotenv import load_dotenv
load_dotenv ()</p>
<pre tabindex="0"><code>
Another very important step for you to run Gitbuild is to grant access to Github to AWS. You need to get your personal access key from Github and use the following command.
``bash
aws codebuild import-source-credentials --server-type GITHUB --auth-type PERSONAL_ACCESS_TOKEN --token &lt;token_value&gt;
</code></pre>
<div class="notices warning" ><p>When creating personal access from Github, you need to give AWS permissions. If it fails, it is necessary to check the rights of the token</p>
</div>

<h2 id="create-github-source-1">Create Github Source</h2>
<p>In the console, select Source from the console as shown in the image:
<img src="/images/2023-07-20-02-08-52.png" alt=""></p>
<p>But in CDK, you need to create Github Source with code. You can find out more at [Github Source] (<a href="https://docs.aws.amazon.com/cdk/api/latest/python/aws_cdk.aws_codebuild/Source.html#aws_cdk.aws_codebuild.Source.git_hub)">https://docs.aws.amazon.com/cdk/api/latest/python/aws_cdk.aws_codebuild/Source.html#aws_cdk.aws_codebuild.Source.git_hub)</a>.</p>
<p>``python</p>
<h1 id="create-github-source-2">Create Github Source</h1>
<p>github_source = codebuild.source.git_hub (
owner=f &ldquo;{GITHUB_OWNER}”,
repo=f &ldquo;{GITHUB_REPO}”,
webhook=True,
branch_or_ref=f &ldquo;{GITHUB_BRANCH}”,</p>
<h1 id="there-are-an-option-called-webhook_filters-that-is-for-the-webhook-event-filter-on-aws-leave-it-as-default-1">there are an option called webhook_filters: that is for the Webhook Event Filter on AWS. Leave it as default</h1>
<p>)</p>
<pre tabindex="0"><code>## Create Environment
In the console, in the Environment tab, you need to

- Select Operating System (I use Ubuntu)
- tick privilege to allow docker build
- Create a new role or select an existing one

![](/images/2023-07-20-02-12-58.png)

In CDK, to create a new role 
``python
# Create the role for the CodeBuild Project
codebuild_role = iam.role (
scope=self,
id=&#34;JobScrapingCicDrole”,
Role_name=&#34;JobScrapingCicDrole”,
Assumed_by=Iam.servicePrincipal (“codebuild.amazonaws.com”),

# add the full S3 access to the role
managed_policies= [
IAM.ManagedPolicy.From_AWS_Managed_Policy_Name (
managed_policy_name=&#34;Amazons3fullAccess”
),

# add the full ECR access to the role
IAM.ManagedPolicy.From_AWS_Managed_Policy_Name (
managed_policy_name=&#34;Amazonec2ContainerRegistryFullAccess”
),

]]

)
</code></pre><p>After that, you can create a Codebuild Project. Parts like operating system, tick privilege can be done here. You can see in the code below, I named it, description, assigned the source as github, created the environment as Linux Standard 7.0 similar to the console, tick privilege and choose the role as the role just created.</p>
<p>``python</p>
<h1 id="create-the-codebuild-project-2">Create the CodeBuild Project</h1>
<p>CodeBuild.project (
scope=self,
id=&ldquo;CicdProject”,
Project_name=&ldquo;cicdProject”,</p>
<h1 id="add-description-1">add description</h1>
<p>description=&ldquo;CodeBuild Project for the CICD for Job Scraping Project”,</p>
<h1 id="set-the-source-1">set the source</h1>
<p>source=github_source,</p>
<h1 id="add-some-environment-variables-1">add some environment variables</h1>
<p>environment=CodeBuild.BuildEnvironment (</p>
<h1 id="add-the-base-environment-variable-1">add the Base Environment Variable</h1>
<p>build_image=codebuild.linuxbuildimage.standard_7_0,</p>
<h1 id="set-the-privilege-to-true-for-docker-build-1">set the privilege to true for docker build</h1>
<p>privileged=True,             <br>
),</p>
<h1 id="create-a-role-for-the-codebuild-project">Create a role for the CodeBuild Project</h1>
<p>role=codebuild_role,
)</p>
<pre tabindex="0"><code>
So you have completed the CI/CD.
</code></pre>




<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/6-cdk/" title="Building a workshop with CDK"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/6-cdk/6.2-runtask/" title="AWS Batch Design" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1690341069"></script>
    <script src="/js/perfect-scrollbar.min.js?1690341069"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1690341069"></script>
    <script src="/js/jquery.sticky.js?1690341069"></script>
    <script src="/js/featherlight.min.js?1690341069"></script>
    <script src="/js/highlight.pack.js?1690341069"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1690341069"></script>
    <script src="/js/learn.js?1690341069"></script>
    <script src="/js/hugo-learn.js?1690341069"></script>

    <link href="/mermaid/mermaid.css?1690341069" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1690341069"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
